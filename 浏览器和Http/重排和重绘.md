
### 重排
当DOM的变化影响了元素的几何信息(元素的的位置和尺寸大小)，浏览器需要重新计算元素的几何属性，将其安放在界面中的正确位置，这个过程叫做重排。重排也叫回流，简单的说就是重新生成布局，重新排列元素。

**下面情况会发生重排**

* 页面初始渲染，这是开销最大的一次重排
* 添加/删除可见的DOM元素
* 改变元素位置
* 改变元素尺寸，比如边距、填充、边框、宽度和高度等
* 改变元素内容，比如文字数量，图片大小等
* 改变元素字体大小
* 改变浏览器窗口尺寸，比如resize事件发生时
* 激活CSS伪类（例如：:hover）
* 设置 style 属性的值，因为通过设置style属性改变结点样式的话，每一次设置都会触发一次reflow
* 查询某些属性或调用某些计算方法：offsetWidth、offsetHeight等，除此之外，当我们调用 getComputedStyle方法，或者IE里的 currentStyle 时，也会触发重排，原理是一样的，都为求一个“即时性”和“准确性”。

**重排影响的范围：**

由于浏览器渲染界面是基于流式布局模型的，所以触发重排时会对周围DOM重新排列，影响的范围有两种：

* 全局范围：从根节点html开始对整个渲染树进行重新布局。
* 局部范围：对渲染树的某部分或某一个渲染对象进行重新布局
用局部布局来解释这种现象：把一个dom的宽高之类的几何信息定死，然后在dom内部触发重排，就只会重新渲染该dom内部的元素，而不会影响到外界。

**重排优化建议**

减少重排范围

* 尽可能在低层级的DOM节点上，而不是像上述全局范围的示例代码一样，如果你要改变p的样式，class就不要加在div上，通过父元素去影响子元素不好。
* 不要使用 table 布局，可能很小的一个小改动会造成整个 table 的重新布局。那么在不得已使用table的场合，可以设置table-layout:auto;或者是table-layout:fixed这样可以让table一行一行的渲染，这种做法也是为了限制reflow的影响范围

减少重排次数

* 样式集中改变：不要频繁的操作样式，对于一个静态页面来说，明智且可维护的做法是更改类名而不是修改样式，对于动态改变的样式来说，相较每次微小修改都直接触及元素，更好的办法是统一在 cssText 变量中编辑。虽然现在大部分现代浏览器都会有 Flush 队列进行渲染队列优化，但是有些老版本的浏览器比如IE6的效率依然低下
* 分离读写操作：DOM 的多个读操作（或多个写操作），应该放在一起。不要两个读操作之间，加入一个写操作。
* 将DOM元素离线：使用display:none将元素离线，元素便不会再存在在渲染树中，然后操作完成后，在通过display将元素显示，这样只会触发一次重排
* 使用 absolute 或 fixed 脱离文档流：使用绝对定位会使的该元素单独成为渲染树中 body 的一个子元素，重排开销比较小，不会对其它节点造成太多影响。当你在这些节点上放置这个元素时，一些其它在这个区域内的节点可能需要重绘，但是不需要重排。这样只是局部重排
* 优化动画

### 重绘(Repaints):
当一个元素的外观发生改变，但没有改变布局,重新把元素外观绘制出来的过程，叫做重绘。

**常见的引起重绘的属性：**

color，border-style，visibility，background，text-decoration，background-image，background-position，background-repeat，outline-color，outline，outline-style，border-radius，outline-width，box-shadow，background-size

注意： 重排必定引发重绘，重绘不一定引发重排

