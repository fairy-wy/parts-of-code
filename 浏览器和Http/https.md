
### HTTPS

HTTPS协议就是“HTTP协议”和“SSL/TLS协议”的组合，SSL/TLS协议具有机密性、认证、完整性和重放保护的功能。通过HTTP over SSL 或 HTTP over TLS ，对http协议的文本数据进行加密处理后，成为二进制形式传输，从而加强了传输的安全可靠性。

**加密算法**

* 对称加密：加密和解密都是使用的同一个密钥。（DES、AES-GCM、ChaCha20-Poly1305等）

* 非对称加密：加密使用的密钥和解密使用的密钥是不相同的，分别称为：公钥、私钥，公钥和算法都是公开的，私钥是保密的（RSA、DSA、ECDSA、 DH、ECDHE）

* 哈希算法：将任意长度的信息转换为较短的固定长度的值，通常其长度要比信息小得多，且算法不可逆。（MD5、SHA-1、SHA-2、SHA-256）

* 数字签名：签名就是在信息的后面再加上一段内容（信息经过hash后的值），可以证明信息没有被修改过。hash值一般都会加密后（也就是签名）再和信息一起发送，以保证这个hash值不被修改。


**https通信过程**

1. 客户端发起HTTPS请求，连接到服务器的443端口。

   * 客户端支持的TTL/SSL的版本
   * 客户端支持的加密套件列表（加密算法）
   * 一个用于后期生产会话秘钥的随机数1

2. 服务器传送给客户端（1.确认使用的TTL/SSL版本。2.确认的加密算法。3.一个用于后期生产会话秘钥的随机数2。4.数字证书）。数字证书可以是受信任机构颁发的，也可以是自己制作的。数字证书含的具体内容有：

    * 证书的发布机构CA
    * 证书的有效期
    * 公钥
    * 证书所有者
    * 数字签名

3. 客户端解析验证服务器证书。验证流程如下：

    * 首先客户端读取证书中的证书所有者、有效期等信息进行一一校验
    * 客户端开始查找操作系统中已内置的受信任的证书发布机构CA，与服务器发来的证书中的颁发者CA比对，用于校验证书是否为合法机构颁发
    * 如果找不到，客户端就会报错；如果找到，那么客户端就会从操作系统中取出 颁发者CA 的公钥，然后对服务器发来的证书里面的签名进行解密
    * 客户端使用相同的hash算法计算出服务器发来的证书的hash值，将这个计算的hash值与证书中签名做对比
    * 对比结果一致，则证明服务器发来的证书合法
    * 如果证书没有问题，那么就生成一个随机数3，然后将随机数1，随机数2，随机数3通过与服务器商量好的算法组装会话密钥，利用服务器中数字证书中的公钥对会话密钥进行加密发送给服务器。

4. 客户端将加密信息（对称加密的公钥）传送服务器。传送的是用证书中公钥加密后的随机值，目的就是让服务端得到这个随机值，以后客户端和服务端的通信就可以通过这个随机值来进行加密解密了。

5. 服务端解密信息。服务端将客户端发送过来的加密信息用服务器私钥解密后，得到了客户端传过来的随机值（对称加密的公钥）。

6. 服务器加密信息并发送信息。服务器将数据利用随机值进行对称加密,再发送给客户端。

7. 客户端接收并解密信息。客户端用之前生成的随机值解密服务段传过来的数据，于是获取了解密后的内容。

**总结**

相比 HTTP 协议，HTTPS 协议增加了很多握手、加密解密等流程，虽然过程很复杂，但其可以保证数据传输的安全。利用数字证书协商非对称加密算法，用非对称加密算法传输对称加密的公钥，最后利用对称加密算法传输数据。
